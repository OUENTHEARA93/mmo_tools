{% extends 'layout.html' %}
{% block menu_open_facebook %} menu-close {% endblock %}
{% block active_device %}
active
{% endblock %}
{% block content %}
<div class="content-header">
    <h1>DEVICE MANAGEMENT</h1>
</div>

<div class="content">

    <!-- Search Filter Section -->
    <div class="filter-section">
        <form id="filter-form" method="GET">
            <div class="row">
                <!-- Combo box for filtering by category -->
                <div class="col-md-2">
                    <label for="category">Category:</label>
                    <select class="form-control" id="category" name="category">
                        <option value="">All</option>
                        <option value="Category1">Short</option>
                        <option value="Category1">Monetization</option>
                        <option value="Category2">Traffic</option>

                    </select>
                </div>

                <!-- Text box for searching -->
                <div class="col-md-3">
                    <label for="search">Search:</label>
                    <input class="form-control" id="search" name="search" placeholder="Enter keyword..." type="text">
                </div>

                <!-- Submit Button for filtering -->
                <!--                <div class="col-md-2">-->
                <!--                    <label>&nbsp;</label>-->
                <!--                    <button class="btn btn-primary btn-block" type="submit">Filter</button>-->
                <!--                </div>-->
                <!-- Submit Button for filtering -->
                <div class="col-md-2">
                    <label>&nbsp;</label>
                    <button class="btn btn-primary btn-block" id="checkDevice" type="button">Check Device</button>
                    <!-- Dialog Form for Adding New Bank -->
                </div>
                <div class="col-md-2">
                    <label>&nbsp;</label>
                    <button class="btn btn-primary btn-block" id="addNewBtn" type="button">Add New</button>
                    <!-- Dialog Form for Adding New Bank -->
                </div>
            </div>
        </form>
    </div>
    <div class="modal" id="addDeviceModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add New Device</h5>
                    <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
                </div>
                <div class="modal-body">
                    <form id="gmailForm">
                        <div class="mb-2">
                            <label class="form-label" for="name">Name</label>
                            <input class="form-control" id="name" required type="text">
                        </div>
                        <div class="mb-2">
                            <label class="form-label" for="gmail">Gmail</label>
                            <input class="form-control" id="gmail" required type="text">
                        </div>
                        <div class="mb-2">
                            <label class="form-label" for="password">Password</label>
                            <input class="form-control" id="password" required type="text">
                        </div>
                        <div class="mb-2">
                            <label class="form-label" for="verify">Verify Phone/Gmail(Optional)</label>
                            <input class="form-control" id="verify" type="phone">
                        </div>
                        <div class="mb-2">
                            <label class="form-label" for="status">Status</label>
                            <select class="form-control" id="status">
                                <option value="Enable">Enable</option>
                                <option value="Disable">Disable</option>
                            </select>
                        </div>
                        <div class="mb-2">
                            <label class="form-label" for="description">Description</label>
                            <textarea class="form-control" id="description" rows="2"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" data-bs-dismiss="modal" type="button">Cancel</button>
                    <button class="btn btn-primary" id="submitGmailBtn" type="button">Add New</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Table for Account Data -->
    <table class="table table-hover mt-4">
        <thead>
                <tr>
                    <th style="width:20px;"><input type="checkbox" id="checkAll"></th>
                    <th>No</th>
                    <th>Name</th>
                    <th>Type</th>
                    <th>Version</th>
                    <th>Category</th>
                    <th>Status</th>
                    <th>Last Open</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody id="deviceTable">
                {% for item in items %}
                <tr>
                    <td><input type="checkbox" class="row-checkbox"></td>
                    <td>{{ '%03d' % (loop.index + (pagination.page - 1) * pagination.per_page) }}</td>
                    <td>
<!--                        {{ item.name }}-->
                        <span class="badge badge-success">{{ item.name }}</span>
                    </td>
                    <td>{{ item.type }}</td>
                    <td>{{ item.os_version }}</td>
                    <td>Facebook</td>
                    <td>
                        <span class="badge badge-success">{{ item.status }}</span>
                    </td>
                    <td>{{ item.last_login }}</td>
                    <td></td>
                </tr>
                {% endfor %}
            </tbody>
    </table>
    <!-- Pagination Controls -->
    {% if pagination.pages > 1 %}
    <nav aria-label="Page navigation">
        <ul class="pagination">
            {% if pagination.has_prev %}
            <li class="page-item">
                <a class="page-link" href="{{ url_for('check_device', page=pagination.prev_num) }}">Previous</a>
            </li>
            {% endif %}

            {% for page_num in pagination.iter_pages() %}
            {% if page_num %}
            <li class="page-item {{ 'active' if page_num == pagination.page else '' }}">
                <a class="page-link" href="{{ url_for('check_device', page=page_num) }}">{{ page_num }}</a>
            </li>
            {% endif %}
            {% endfor %}

            {% if pagination.has_next %}
            <li class="page-item">
                <a class="page-link" href="{{ url_for('check_device', page=pagination.next_num) }}">Next</a>
            </li>
            {% endif %}
        </ul>
    </nav>
    {% endif %}


    <!-- Context Menu -->
    <div class="dropdown-menu shadow" id="context-menu" style="position: absolute; display: none;">
        <a class="dropdown-item" href="#" id="context-edit">
            <i class="fas fa-check"></i> Select
        </a>
        <a class="dropdown-item" href="#" id="context-unselect">
            <i class="fas fa-times"></i> Unselect
        </a>

        <div class="dropdown-divider"></div>
        <a class="dropdown-item" href="#" id="context-view">
            <i class="fas fa-eye"></i> Install Apk File
        </a>
        <a class="dropdown-item" href="#" id="context-create">
            <i class="fas fa-cogs"></i> Check Root
        </a>
        <a class="dropdown-item" href="#" id="context-ipaddress">
            <i class="fas fa-network-wired"></i> Check Ip Address
        </a>
        <div class="dropdown-divider"></div>
        <a class="dropdown-item" href="#" id="context-copy">
            <i class="fas fa-times"></i> Copy
        </a>
        <a class="dropdown-item" href="#" id="context-delete">
            <i class="fas fa-trash-alt"></i> Delete
        </a>
        <a class="dropdown-item" href="#" id="context-update">
            <i class="fas fa-marker"></i> Update Account info
        </a>

    </div>

</div>
{% endblock %}
{% block scripts %}
<script src="/static/AdminLTE/js/device.js"></script>
<!--<script>-->


<!--    $(document).ready(function () {-->

<!--            $('#addNewBtn').click(function() {-->

<!--                $('#addDeviceModal').modal('show');-->
<!--            });-->

<!--            $('#checkDevice').click(function () {-->
<!--                loadData();-->
<!--            });-->


<!--            function loadData(){-->
<!--                $.ajax({-->
<!--                    url: "/check_device",-->
<!--                    method: "GET",-->
<!--                    success: function (data) {-->
<!--                        var rows = "";-->

<!--                        data.forEach(function (device) {-->
<!--                            rows += "<tr>";-->
<!--                            rows += "<td><input type='checkbox'>"+ "</td>";-->
<!--                            rows += "<td>" + device.No + "</td>";-->
<!--                            rows += "<td>" + device.Name + "</td>";-->
<!--                            rows += "<td>" + device['OS Version'] + "</td>";-->
<!--                            rows += "<td>" + device['App Installed'] + "</td>";-->
<!--                            rows += "<td>" + device.Category + "</td>";-->
<!--                            rows += "<td><span class='badge badge-success'>" + device.Status + "</span></td>";-->
<!--                            rows += "<td>" + device.Description + "</td>";-->
<!--                            rows += "</tr>";-->
<!--                        });-->
<!--                        $('#deviceTable').html(rows);-->
<!--                    }-->
<!--                });-->
<!--            };-->
<!--        });-->

<!--</script>-->
{% endblock %}

